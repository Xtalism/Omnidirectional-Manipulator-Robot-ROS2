<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="robot_omni_3d">

  <!-- Materials -->
  <material name="blue">
    <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1"/>
  </material>
  <material name="gray">
    <color rgba="0.752941176470588 0.752941176470588 0.752941176470588 1"/>
  </material>

  <!-- Base Link -->
  <xacro:macro name="base_link" params="parent *origin">
    <link name="base_link">
      <inertial>
        <origin xyz="0.000101168364989104 -0.00377722152863208 0.0460516576627933" rpy="0 0 0"/>
        <mass value="0.577281083216241"/>
        <inertia ixx="0.00162450670599958" ixy="-4.63440581983851E-07" ixz="-2.10706591377875E-08" iyy="0.000877404129357638" iyz="1.3538679556105E-07" izz="0.00178173129381051"/>
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/base_link.STL"/>
        </geometry>
        <material name="blue"/>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/base_link.STL"/>
        </geometry>
      </collision>
    </link>
  </xacro:macro>

  <!-- Wheel Macro -->
  <xacro:macro name="wheel" params="name parent xyz rpy axis">
    <link name="${name}_wheel_link">
      <inertial>
        <origin xyz="4.52085493402032E-06 -4.88664378021919E-05 -0.0179706540332964" rpy="0 0 0"/>
        <mass value="0.123795234111436"/>
        <inertia ixx="2.36708966689132E-05" ixy="-5.47275866691368E-11" ixz="-2.37723215757676E-12" iyy="2.36713215795414E-05" iyz="-5.93576540349247E-13" izz="3.12049313661706E-05"/>
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/${name}_wheel_link.STL"/>
        </geometry>
        <material name="gray"/>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/${name}_wheel_link.STL"/>
        </geometry>
      </collision>
    </link>
    
    <joint name="${name}_wheel_joint" type="continuous">
      <origin xyz="${xyz}" rpy="${rpy}"/>
      <parent link="${parent}"/>
      <child link="${name}_wheel_link"/>
      <axis xyz="${axis}"/>
    </joint>
  </xacro:macro>

  <!-- Arm Link Macro -->
  <xacro:macro name="arm_link" params="name parent xyz rpy axis limits:='-1.57 1.57' joint_type:='revolute' *visual *inertial">
    <link name="${name}">
      <xacro:insert_block name="inertial"/>
      <xacro:insert_block name="visual"/>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/${name}.STL"/>
        </geometry>
      </collision>
    </link>
    
    <joint name="joint_${name[-1]}" type="${joint_type}">
      <origin xyz="${xyz}" rpy="${rpy}"/>
      <parent link="${parent}"/>
      <child link="${name}"/>
      <axis xyz="${axis}"/>
      <limit lower="${limits.split()[0]}" upper="${limits.split()[1]}" effort="10" velocity="100"/>
    </joint>
  </xacro:macro>

  <!-- Base Link -->
  <link name="base_link">
    <inertial>
      <origin xyz="0.000101168364989104 -0.00377722152863208 0.0460516576627933" rpy="0 0 0"/>
      <mass value="0.577281083216241"/>
      <inertia ixx="0.00162450670599958" ixy="-4.63440581983851E-07" ixz="-2.10706591377875E-08" iyy="0.000877404129357638" iyz="1.3538679556105E-07" izz="0.00178173129381051"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/base_link.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/base_link.STL"/>
      </geometry>
    </collision>
  </link>

  <!-- Wheels -->
  <xacro:wheel name="fl" parent="base_link" xyz="0.11788 -0.081567 -0.037794" rpy="1.5708 0 1.5708" axis="0 0 1"/>
  <xacro:wheel name="rl" parent="base_link" xyz="0.11788 0.081569 -0.037789" rpy="1.5708 0 1.5708" axis="0 0 1"/>
  <xacro:wheel name="fr" parent="base_link" xyz="-0.11788 -0.081566 -0.037705" rpy="1.5708 0 -1.5708" axis="0 0 1"/>
  <xacro:wheel name="rr" parent="base_link" xyz="-0.11788 0.081609 -0.037681" rpy="-1.5708 0 1.5708" axis="0 0 1"/>

  <!-- Arm Links -->
  <xacro:arm_link name="Link_1" parent="base_link" xyz="0.0099965 -0.062847 0.12528" rpy="-1.5708 0 -1.5708" axis="0 1 0" limits="-1.57 0">
    <inertial>
      <origin xyz="0.000506046615463357 0.00691496728629516 -0.0122755959836562" rpy="0 0 0"/>
      <mass value="0.0382070631949755"/>
      <inertia ixx="6.05895904112999E-06" ixy="-3.26790900435385E-10" ixz="1.70232643106716E-08" iyy="1.06084491676467E-05" iyz="1.55715035338171E-07" izz="7.32724940736577E-06"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/Link_1.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
  </xacro:arm_link>

  <xacro:arm_link name="Link_2" parent="Link_1" xyz="0.010077 0.0057856 0.01" rpy="0 0 0" axis="0 0 1" limits="0 0.45">
    <inertial>
      <origin xyz="0.0519935153424735 9.31325867987998E-10 -0.0241591323242931" rpy="0 0 0"/>
      <mass value="0.0170251169263654"/>
      <inertia ixx="1.08907010787336E-05" ixy="3.11047077367638E-08" ixz="-5.74856746591523E-21" iyy="1.68733569095532E-05" iyz="1.46608453476581E-21" izz="7.85969468178107E-06"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/Link_2.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
  </xacro:arm_link>

  <xacro:arm_link name="Link_3" parent="Link_2" xyz="0.10399 0 -0.01" rpy="3.1416 0 3.1416" axis="0 0 1" limits="-1.57 1.5708">
    <inertial>
      <origin xyz="-0.00145033630413227 -0.00137973727908961 0.0156275288663969" rpy="0 0 0"/>
      <mass value="0.0494773487894258"/>
      <inertia ixx="1.18336660189981E-05" ixy="1.24373046667324E-07" ixz="-1.86477617019496E-08" iyy="1.954406916305E-05" iyz="-1.55737377757555E-07" izz="1.17899796886126E-05"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/Link_3.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
  </xacro:arm_link>

  <xacro:arm_link name="Link_4" parent="Link_3" xyz="-0.076947 0.0002706 0" rpy="-3.1416 0 1.5708" axis="0 0 1" limits="-1.5708 1.57">
    <inertial>
      <origin xyz="-0.0095710650310705 -0.00112932990654074 -0.0161449114265881" rpy="0 0 0"/>
      <mass value="0.0382070631949756"/>
      <inertia ixx="6.05895904112999E-06" ixy="3.26790900332788E-10" ixz="-1.70232643106688E-08" iyy="1.06084491676467E-05" iyz="1.55715035338175E-07" izz="7.32724940736576E-06"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/Link_4.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
  </xacro:arm_link>

  <xacro:arm_link name="Link_5" parent="Link_4" xyz="-0.0059012 -0.040229 -0.050049" rpy="1.5708 -1.5708 0" axis="0 0 0" joint_type="fixed">
    <inertial>
      <origin xyz="0.028833786920895 0.00413587714794112 -0.0028584998515091" rpy="0 0 0"/>
      <mass value="0.0373359018111918"/>
      <inertia ixx="6.03560504196294E-06" ixy="3.26790897789057E-10" ixz="-1.70232643103967E-08" iyy="1.05850951684802E-05" iyz="1.55715035337853E-07" izz="7.28302147533164E-06"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/Link_5.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
  </xacro:arm_link>

  <!-- End Effector -->
  <xacro:arm_link name="end_effector" parent="Link_5" xyz="0.038628 0.0052916 0.019564" rpy="0 0 1.5708" axis="0 0 1" limits="-1.57 0">
    <inertial>
      <origin xyz="0.00052063255921888 0.000297558030083706 0.0577395076620412" rpy="0 0 0"/>
      <mass value="0.0268863153129509"/>
      <inertia ixx="7.16843100504782E-06" ixy="-2.16004182896192E-18" ixz="1.45205222495832E-17" iyy="5.41074299136263E-06" iyz="-6.95119128869655E-08" izz="1.95010952707155E-06"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="file://$(find mec_mobile_description)/meshes/robot_omni_3d/end_effector.STL"/>
      </geometry>
      <material name="blue"/>
    </visual>
  </xacro:arm_link>

</robot>